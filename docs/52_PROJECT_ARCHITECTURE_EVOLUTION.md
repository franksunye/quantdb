# QuantDB é¡¹ç›®æ¶æ„æ¼”è¿›è§„åˆ’

**ç‰ˆæœ¬**: v2.0-architecture | **ç›®æ ‡**: å¤šæ¨¡å¼éƒ¨ç½²æ¶æ„ | **ç­–ç•¥**: æ¸è¿›å¼æ¼”è¿›

## ğŸ¯ æ¶æ„æ¼”è¿›ç›®æ ‡

### å½“å‰çŠ¶æ€ (v1.x)
- âœ… åç«¯APIæœåŠ¡ (FastAPI)
- âœ… å‰ç«¯å±•ç¤ºåº”ç”¨ (Streamlit)
- âœ… æ•°æ®åº“å’Œç¼“å­˜ç³»ç»Ÿ (SQLite + æ™ºèƒ½ç¼“å­˜)

### ç›®æ ‡çŠ¶æ€ (v2.x)
1. **ğŸ”§ åç«¯APIæœåŠ¡** - ç‹¬ç«‹çš„APIæœåŠ¡ï¼Œå¯å•ç‹¬éƒ¨ç½²å’Œè°ƒç”¨
2. **ğŸ‘¨â€ğŸ’¼ ç®¡ç†åå°** - Adminç®¡ç†ç•Œé¢ï¼Œæ•°æ®ç®¡ç†å’Œç³»ç»Ÿç›‘æ§
3. **ğŸŒ å‰ç«¯SaaSåº”ç”¨** - ç‹¬ç«‹çš„ç”¨æˆ·ä½“éªŒåº”ç”¨ï¼Œå¯å…¬å¼€è®¿é—®

## ğŸ—ï¸ æ¨èé¡¹ç›®ç»“æ„

```
quantdb/
â”œâ”€â”€ README.md                           # é¡¹ç›®æ€»è§ˆ
â”œâ”€â”€ docker-compose.yml                  # å¤šæœåŠ¡ç¼–æ’
â”œâ”€â”€ .env.example                        # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ 
â”œâ”€â”€ core/                              # ğŸ”¥ æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ models/                        # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ asset.py
â”‚   â”‚   â”œâ”€â”€ stock_data.py
â”‚   â”‚   â””â”€â”€ system_metrics.py
â”‚   â”œâ”€â”€ services/                      # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ stock_data_service.py
â”‚   â”‚   â”œâ”€â”€ asset_info_service.py
â”‚   â”‚   â”œâ”€â”€ trading_calendar.py
â”‚   â”‚   â””â”€â”€ cache_service.py
â”‚   â”œâ”€â”€ database/                      # æ•°æ®åº“å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ connection.py
â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ schema.sql
â”‚   â”œâ”€â”€ cache/                         # ç¼“å­˜å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ akshare_adapter.py
â”‚   â”‚   â””â”€â”€ cache_manager.py
â”‚   â””â”€â”€ utils/                         # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ logger.py
â”‚       â”œâ”€â”€ validators.py
â”‚       â””â”€â”€ helpers.py
â”‚
â”œâ”€â”€ api/                               # ğŸš€ åç«¯APIæœåŠ¡
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                        # FastAPIåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ dependencies.py               # ä¾èµ–æ³¨å…¥
â”‚   â”œâ”€â”€ middleware.py                 # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ routes/                       # APIè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ health.py
â”‚   â”‚   â”œâ”€â”€ stocks.py
â”‚   â”‚   â”œâ”€â”€ assets.py
â”‚   â”‚   â”œâ”€â”€ cache.py
â”‚   â”‚   â””â”€â”€ admin.py
â”‚   â”œâ”€â”€ schemas/                      # APIæ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ stock.py
â”‚   â”‚   â”œâ”€â”€ asset.py
â”‚   â”‚   â””â”€â”€ response.py
â”‚   â”œâ”€â”€ auth/                         # è®¤è¯æˆæƒ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ jwt_handler.py
â”‚   â”‚   â””â”€â”€ permissions.py
â”‚   â”œâ”€â”€ requirements.txt              # APIæœåŠ¡ä¾èµ–
â”‚   â”œâ”€â”€ Dockerfile                    # APIå®¹å™¨åŒ–
â”‚   â””â”€â”€ README.md                     # APIæœåŠ¡æ–‡æ¡£
â”‚
â”œâ”€â”€ admin/                            # ğŸ‘¨â€ğŸ’¼ ç®¡ç†åå°
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ app.py                        # Streamlit Adminåº”ç”¨
â”‚   â”œâ”€â”€ pages/                        # ç®¡ç†é¡µé¢
â”‚   â”‚   â”œâ”€â”€ 1_ğŸ“Š_æ•°æ®æ¦‚è§ˆ.py
â”‚   â”‚   â”œâ”€â”€ 2_ğŸ—„ï¸_æ•°æ®ç®¡ç†.py
â”‚   â”‚   â”œâ”€â”€ 3_âš¡_ç³»ç»Ÿç›‘æ§.py
â”‚   â”‚   â”œâ”€â”€ 4_ğŸ‘¥_ç”¨æˆ·ç®¡ç†.py
â”‚   â”‚   â””â”€â”€ 5_âš™ï¸_ç³»ç»Ÿè®¾ç½®.py
â”‚   â”œâ”€â”€ components/                   # ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ data_table.py
â”‚   â”‚   â”œâ”€â”€ charts.py
â”‚   â”‚   â””â”€â”€ forms.py
â”‚   â”œâ”€â”€ auth/                         # ç®¡ç†å‘˜è®¤è¯
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ admin_auth.py
â”‚   â”œâ”€â”€ requirements.txt              # Adminä¾èµ–
â”‚   â”œâ”€â”€ Dockerfile                    # Adminå®¹å™¨åŒ–
â”‚   â””â”€â”€ README.md                     # Adminä½¿ç”¨æ–‡æ¡£
â”‚
â”œâ”€â”€ webapp/                           # ğŸŒ å‰ç«¯SaaSåº”ç”¨
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ app.py                        # ä¸»åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ pages/                        # ç”¨æˆ·é¡µé¢
â”‚   â”‚   â”œâ”€â”€ 1_ğŸ“ˆ_è‚¡ç¥¨æŸ¥è¯¢.py
â”‚   â”‚   â”œâ”€â”€ 2_ğŸ“Š_èµ„äº§åˆ†æ.py
â”‚   â”‚   â”œâ”€â”€ 3_ğŸ“‹_æˆ‘çš„å…³æ³¨.py
â”‚   â”‚   â””â”€â”€ 4_âš™ï¸_ä¸ªäººè®¾ç½®.py
â”‚   â”œâ”€â”€ components/                   # UIç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ stock_chart.py
â”‚   â”‚   â”œâ”€â”€ data_table.py
â”‚   â”‚   â””â”€â”€ sidebar.py
â”‚   â”œâ”€â”€ utils/                        # å‰ç«¯å·¥å…·
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ api_client.py
â”‚   â”‚   â”œâ”€â”€ session_manager.py
â”‚   â”‚   â””â”€â”€ formatters.py
â”‚   â”œâ”€â”€ auth/                         # ç”¨æˆ·è®¤è¯
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ user_auth.py
â”‚   â”œâ”€â”€ requirements.txt              # WebAppä¾èµ–
â”‚   â”œâ”€â”€ Dockerfile                    # WebAppå®¹å™¨åŒ–
â”‚   â””â”€â”€ README.md                     # WebAppä½¿ç”¨æ–‡æ¡£
â”‚
â”œâ”€â”€ cloud/                            # â˜ï¸ äº‘ç«¯éƒ¨ç½²ç‰ˆæœ¬
â”‚   â”œâ”€â”€ streamlit_cloud/             # Streamlit Cloudç‰ˆæœ¬
â”‚   â”‚   â”œâ”€â”€ app.py                    # å•ä½“åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”œâ”€â”€ vercel/                       # Verceléƒ¨ç½²ç‰ˆæœ¬
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â””â”€â”€ vercel.json
â”‚   â””â”€â”€ docker/                       # Dockeréƒ¨ç½²ç‰ˆæœ¬
â”‚       â”œâ”€â”€ docker-compose.yml
â”‚       â”œâ”€â”€ nginx.conf
â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ database/                         # ğŸ—„ï¸ æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ stock_data.db                # SQLiteæ•°æ®åº“
â”‚   â”œâ”€â”€ schema.sql                   # æ•°æ®åº“ç»“æ„
â”‚   â””â”€â”€ migrations/                  # æ•°æ®åº“è¿ç§»
â”‚
â”œâ”€â”€ tests/                           # ğŸ§ª æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py
â”‚   â”œâ”€â”€ unit/                        # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/                 # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ api/                         # APIæµ‹è¯•
â”‚   â””â”€â”€ e2e/                         # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚
â”œâ”€â”€ docs/                            # ğŸ“š é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ api/                         # APIæ–‡æ¡£
â”‚   â”œâ”€â”€ admin/                       # ç®¡ç†æ–‡æ¡£
â”‚   â”œâ”€â”€ webapp/                      # åº”ç”¨æ–‡æ¡£
â”‚   â”œâ”€â”€ deployment/                  # éƒ¨ç½²æ–‡æ¡£
â”‚   â””â”€â”€ architecture/               # æ¶æ„æ–‡æ¡£
â”‚
â”œâ”€â”€ scripts/                         # ğŸ”§ ç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ setup.py                     # ç¯å¢ƒè®¾ç½®
â”‚   â”œâ”€â”€ deploy.py                    # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ backup.py                    # æ•°æ®å¤‡ä»½
â”‚   â””â”€â”€ migrate.py                   # æ•°æ®è¿ç§»
â”‚
â””â”€â”€ tools/                           # ğŸ› ï¸ å¼€å‘å·¥å…·
    â”œâ”€â”€ monitoring/                  # ç›‘æ§å·¥å…·
    â”œâ”€â”€ performance/                 # æ€§èƒ½æµ‹è¯•
    â””â”€â”€ data_import/                 # æ•°æ®å¯¼å…¥å·¥å…·
```

## ğŸš€ éƒ¨ç½²æ¨¡å¼æ”¯æŒ

### 1. å¼€å‘æ¨¡å¼ (Development)
```bash
# å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.dev.yml up

# æˆ–åˆ†åˆ«å¯åŠ¨
cd api && uvicorn main:app --reload
cd admin && streamlit run app.py --server.port 8501
cd webapp && streamlit run app.py --server.port 8502
```

### 2. APIæœåŠ¡æ¨¡å¼ (API Only)
```bash
# ä»…å¯åŠ¨APIæœåŠ¡
cd api && uvicorn main:app --host 0.0.0.0 --port 8000

# æˆ–ä½¿ç”¨Docker
docker build -t quantdb-api ./api
docker run -p 8000:8000 quantdb-api
```

### 3. ç®¡ç†åå°æ¨¡å¼ (Admin Only)
```bash
# å¯åŠ¨ç®¡ç†åå°
cd admin && streamlit run app.py

# æˆ–ä½¿ç”¨Docker
docker build -t quantdb-admin ./admin
docker run -p 8501:8501 quantdb-admin
```

### 4. SaaSåº”ç”¨æ¨¡å¼ (WebApp Only)
```bash
# å¯åŠ¨å‰ç«¯åº”ç”¨
cd webapp && streamlit run app.py

# æˆ–ä½¿ç”¨Docker
docker build -t quantdb-webapp ./webapp
docker run -p 8502:8502 quantdb-webapp
```

### 5. äº‘ç«¯å•ä½“æ¨¡å¼ (Cloud Monolith)
```bash
# Streamlit Cloudéƒ¨ç½²
cd cloud/streamlit_cloud && streamlit run app.py
```

### 6. å®Œæ•´ç”Ÿäº§æ¨¡å¼ (Full Production)
```bash
# ä½¿ç”¨docker-composeå¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æœåŠ¡è®¿é—®åœ°å€:
# API: http://localhost:8000
# Admin: http://localhost:8501  
# WebApp: http://localhost:8502
# Nginx: http://localhost:80
```

## ğŸ“‹ æ¼”è¿›å®æ–½è®¡åˆ’

### é˜¶æ®µ1: ç»“æ„é‡ç»„ (1å‘¨)
- [ ] åˆ›å»ºæ–°çš„é¡¹ç›®ç»“æ„
- [ ] å°†ç°æœ‰ä»£ç é‡æ–°ç»„ç»‡åˆ°core/ç›®å½•
- [ ] æ›´æ–°importè·¯å¾„å’Œä¾èµ–å…³ç³»
- [ ] ç¡®ä¿ç°æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ

### é˜¶æ®µ2: APIæœåŠ¡ç‹¬ç«‹åŒ– (1å‘¨)
- [ ] å°†FastAPIä»£ç ç§»åŠ¨åˆ°api/ç›®å½•
- [ ] åˆ›å»ºç‹¬ç«‹çš„APIæœåŠ¡é…ç½®
- [ ] æ·»åŠ APIè®¤è¯å’Œæƒé™æ§åˆ¶
- [ ] å®Œå–„APIæ–‡æ¡£å’Œæµ‹è¯•

### é˜¶æ®µ3: ç®¡ç†åå°å¼€å‘ (2å‘¨)
- [ ] åˆ›å»ºadmin/ç›®å½•ç»“æ„
- [ ] å¼€å‘æ•°æ®ç®¡ç†ç•Œé¢
- [ ] å®ç°ç³»ç»Ÿç›‘æ§åŠŸèƒ½
- [ ] æ·»åŠ ç”¨æˆ·ç®¡ç†åŠŸèƒ½

### é˜¶æ®µ4: SaaSåº”ç”¨å¼€å‘ (2å‘¨)
- [ ] åˆ›å»ºwebapp/ç›®å½•ç»“æ„
- [ ] å¼€å‘ç”¨æˆ·å‹å¥½çš„å‰ç«¯ç•Œé¢
- [ ] å®ç°ç”¨æˆ·è®¤è¯å’Œä¸ªäººè®¾ç½®
- [ ] ä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’Œæ€§èƒ½

### é˜¶æ®µ5: äº‘ç«¯éƒ¨ç½²ä¼˜åŒ– (1å‘¨)
- [ ] å®Œå–„cloud/ç›®å½•ä¸‹çš„éƒ¨ç½²ç‰ˆæœ¬
- [ ] ä¼˜åŒ–Streamlit Cloudéƒ¨ç½²
- [ ] æ·»åŠ Dockerå’ŒVerceléƒ¨ç½²æ”¯æŒ
- [ ] å®Œå–„éƒ¨ç½²æ–‡æ¡£

### é˜¶æ®µ6: ç”Ÿäº§ç¯å¢ƒå‡†å¤‡ (1å‘¨)
- [ ] é…ç½®nginxåå‘ä»£ç†
- [ ] æ·»åŠ SSLè¯ä¹¦æ”¯æŒ
- [ ] å®ç°æ—¥å¿—å’Œç›‘æ§
- [ ] æ€§èƒ½ä¼˜åŒ–å’Œå®‰å…¨åŠ å›º

## ğŸ¯ æ¶æ„ä¼˜åŠ¿

### 1. æ¨¡å—åŒ–è®¾è®¡
- **æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å¤ç”¨**: core/ç›®å½•å¯è¢«æ‰€æœ‰åº”ç”¨å…±äº«
- **ç‹¬ç«‹éƒ¨ç½²**: æ¯ä¸ªæœåŠ¡å¯ä»¥ç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•
- **æ¸…æ™°èŒè´£**: APIã€Adminã€WebAppå„å¸å…¶èŒ

### 2. çµæ´»éƒ¨ç½²
- **æŒ‰éœ€éƒ¨ç½²**: å¯ä»¥åªéƒ¨ç½²éœ€è¦çš„æœåŠ¡
- **å¤šç¯å¢ƒæ”¯æŒ**: å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®åˆ†ç¦»
- **å®¹å™¨åŒ–**: æ”¯æŒDockerå®¹å™¨åŒ–éƒ¨ç½²

### 3. å¯æ‰©å±•æ€§
- **æ°´å¹³æ‰©å±•**: APIæœåŠ¡å¯ä»¥å¤šå®ä¾‹éƒ¨ç½²
- **åŠŸèƒ½æ‰©å±•**: æ–°åŠŸèƒ½å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²
- **æŠ€æœ¯æ ˆçµæ´»**: ä¸åŒæœåŠ¡å¯ä»¥ä½¿ç”¨ä¸åŒæŠ€æœ¯æ ˆ

### 4. ç»´æŠ¤æ€§
- **ä»£ç å¤ç”¨**: æ ¸å¿ƒé€»è¾‘ç»Ÿä¸€ç»´æŠ¤
- **ç‹¬ç«‹æµ‹è¯•**: æ¯ä¸ªæœåŠ¡å¯ä»¥ç‹¬ç«‹æµ‹è¯•
- **ç‰ˆæœ¬ç®¡ç†**: æœåŠ¡å¯ä»¥ç‹¬ç«‹ç‰ˆæœ¬æ§åˆ¶

è¿™ä¸ªæ¶æ„è®¾è®¡æ—¢æ»¡è¶³äº†ä½ å½“å‰çš„Streamlit Cloudéƒ¨ç½²éœ€æ±‚ï¼Œåˆä¸ºæœªæ¥çš„æ‰©å±•æä¾›äº†è‰¯å¥½çš„åŸºç¡€ã€‚ä½ è§‰å¾—è¿™ä¸ªè§„åˆ’å¦‚ä½•ï¼Ÿéœ€è¦æˆ‘è¯¦ç»†è¯´æ˜æŸä¸ªéƒ¨åˆ†å—ï¼Ÿ
